
<div id="layout-wrapper">
        {{>header}}
        {{>sidebar}}

        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">
                <div class="container-fluid">



<!DOCTYPE html>
<html>

<head>
    <title>Edit Agent</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body>
    <div class="container mt-5">
        <h1>Edit Agent</h1>
        <form method="POST" action="/talab/editagent/update-agent/{{agentData.id}}">
            <div class="form-group">
                <label for="firstname">First Name:</label>
                <input type="text" class="form-control" name="firstname" value="{{agentData.firstname}}">
            </div>
            <div class="form-group">
                <label for="lastname">Last Name:</label>
                <input type="text" class="form-control" name="lastname" value="{{agentData.lastname}}">
            </div>
            <div class="form-group">
                <label for="address">Address:</label>
                <input type="text" class="form-control" name="address" value="{{agentData.address}}">
            </div>
            <div class="form-group">
                <label for="phonenumber">Phone Number:</label>
                <input type="text" class="form-control" name="phonenumber" value="{{agentData.phonenumber}}">
            </div>
              <div class="form-group">
                <label for="gst">GST Number:</label>
                <input type="text" class="form-control" name="gst" value="{{agentData.gst}}">
            </div>
                <div class="form-group">
                <label for="gst">Email:</label>
                <input type="text" class="form-control" name="email" value="{{agentData.email}}">
            </div>
               <div class="form-group">
                <label for="gst">City:</label>
                <input type="text" class="form-control" name="city" value="{{agentData.city}}">
            </div>
            <div class="form-group">
                <h2>Service Charge</h2>
                <div id="service-charge-fields">
                    {{#each agentData.servicecharge}}
                    <div class="service-charge-field mb-3">
                        <div class="row">
                            <div class="col-md-4">
                                <label for="country">Country:</label>
                                <select name="country[]" class="form-control country-dropdown">
                                    <option value="{{this.country}}" selected>{{this.country}}</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="price">Price:</label>
                                <input type="text" class="form-control" name="price[]" value="{{this.price}}">
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-danger remove-field mt-4">Delete</button>
                            </div>
                        </div>
                    </div>
                    {{/each}}
                </div>
                <button type="button" id="add-country-field" class="btn btn-primary">Add Field</button>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-success" id="edit-btn">Submit</button>
            </div>
        </form>
    </div>
{{>footer}}
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    // Function to fetch country data from an API and populate the dropdown
    function populateCountryDropdown(dropdown) {
        fetch('https://restcountries.com/v3.1/all')
            .then(response => response.json())
            .then(data => {
                data.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country.name.common;
                    option.text = country.name.common;
                    dropdown.append(option);
                });
            })
            .catch(error => console.error('Error fetching countries:', error));
    }

    // Add initial country data to the first dropdown
    populateCountryDropdown($(".country-dropdown").first());

    // Event handler for adding a new "Service Charge" field
    $("#add-country-field").click(function () {
        var newFieldHTML = `
            <div class="service-charge-field mb-3">
                <div class="row">
                    <div class="col-md-4">
                        <label for="country">Country:</label>
                        <select name="country[]" class="form-control country-dropdown">
                            <option value="" selected>Select a country</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="price">Price:</label>
                        <input type="text" name="price[]" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <button type="button" class="btn btn-danger remove-field mt-4">Delete</button>
                    </div>
                </div>
            </div>`;
        $("#service-charge-fields").append(newFieldHTML);

        // Populate the new dropdown with country data
        populateCountryDropdown($(".country-dropdown").last());
    });

    // Event handler for removing a "Service Charge" field
    $(document).on('click', '.remove-field', function () {
        $(this).closest(".service-charge-field").remove();
    });
</script>

</body>
</html>
